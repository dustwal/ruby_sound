fade = Effect.define do |t, sound|
  pos = t/sound.frequency/sound.length
  if pos > 0.95
    [1-(pos-0.95)/0.05, 0].max*sound.sample_at(t)
  else
    [10*pos, 1].min*sound.sample_at(t)
  end
end

sine = FreqSum[[1, 0, 0.5, :sine]] -> fade

triangle = FreqSum[[1, 0, 0.05, :sawtooth], [1, 0, 0.15, :triangle]] -> fade

:<>:Twinkle Twinkle, Little Star (Beginning):<>:

:master:  | (tempo 100)(volume 25) |                     |
sine:     |    c c       g g       | a a       g2        |
triangle: | o2 c <c/e/>g c <c/e/>g | c <c/f/>a c <c/e/>g |

sine:     | f4 f       e e         | d d       c2        ||
triangle: | c  <c/f/>a c <c/e/>g   | d <d/g/>b c <c/e/>g ||
